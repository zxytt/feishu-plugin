# è°ƒè¯•æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ è°ƒè¯•é£ä¹¦æ–‡æ¡£ç­›é€‰æ¡ä»¶è·å–æ’ä»¶ã€‚

## ğŸ“‹ ç›®å½•

1. [æœ¬åœ°å¼€å‘è°ƒè¯•](#æœ¬åœ°å¼€å‘è°ƒè¯•)
2. [é£ä¹¦ç¯å¢ƒè°ƒè¯•](#é£ä¹¦ç¯å¢ƒè°ƒè¯•)
3. [æµè§ˆå™¨å¼€å‘è€…å·¥å…·](#æµè§ˆå™¨å¼€å‘è€…å·¥å…·)
4. [å¸¸è§è°ƒè¯•åœºæ™¯](#å¸¸è§è°ƒè¯•åœºæ™¯)
5. [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)

---

## æœ¬åœ°å¼€å‘è°ƒè¯•

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

### 2. è®¿é—®æœ¬åœ°åœ°å€

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:3000`

### 3. æ‰“å¼€å¼€å‘è€…å·¥å…·

æŒ‰ `F12` æˆ–å³é”®é€‰æ‹©"æ£€æŸ¥"æ‰“å¼€å¼€å‘è€…å·¥å…·ã€‚

### 4. æŸ¥çœ‹æ§åˆ¶å°

åœ¨ Console æ ‡ç­¾ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
è¯·åœ¨é£ä¹¦æ–‡æ¡£ç¯å¢ƒä¸­ä½¿ç”¨æ­¤æ’ä»¶
```

è¿™æ˜¯**æ­£å¸¸çš„**ï¼Œå› ä¸ºæœ¬åœ°æµè§ˆå™¨æ²¡æœ‰ `window.bitable`ã€‚

### 5. æ£€æŸ¥ç½‘ç»œè¯·æ±‚

åœ¨ Network æ ‡ç­¾ä¸­æŸ¥çœ‹ï¼š
- é¡µé¢åŠ è½½æƒ…å†µ
- API è¯·æ±‚ï¼ˆå¦‚æœæœ‰ï¼‰
- é™æ€èµ„æºåŠ è½½

### 6. çƒ­é‡è½½è°ƒè¯•

ä¿®æ”¹ä»£ç åï¼Œé¡µé¢ä¼šè‡ªåŠ¨åˆ·æ–°ï¼Œä½ å¯ä»¥ï¼š
- ä¿®æ”¹ `components/FilterMonitor.tsx`
- ä¿å­˜æ–‡ä»¶
- æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°
- æŸ¥çœ‹æ•ˆæœ

---

## é£ä¹¦ç¯å¢ƒè°ƒè¯•

### æ–¹æ³•ä¸€ï¼šåœ¨é£ä¹¦æ–‡æ¡£ä¸­è°ƒè¯•ï¼ˆæ¨èï¼‰

#### 1. éƒ¨ç½²æ’ä»¶åˆ°å¯è®¿é—®çš„åœ°å€

**é€‰é¡¹ Aï¼šä½¿ç”¨æœ¬åœ°éš§é“ï¼ˆæœ€ç®€å•ï¼‰**

```bash
# å®‰è£… ngrok
npm install -g ngrok

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨ ngrok
ngrok http 3000
```

ä½ ä¼šå¾—åˆ°ä¸€ä¸ªå…¬ç½‘åœ°å€ï¼Œä¾‹å¦‚ï¼š`https://xxxxx.ngrok.io`

**é€‰é¡¹ Bï¼šéƒ¨ç½²åˆ° Vercel**

```bash
npm i -g vercel
vercel
```

#### 2. åœ¨é£ä¹¦å¼€æ”¾å¹³å°é…ç½®æ’ä»¶åœ°å€

1. è¿›å…¥åº”ç”¨è¯¦æƒ…é¡µé¢
2. é…ç½®"åº”ç”¨ä¸»é¡µ URL"ä¸ºä½ çš„åœ°å€
3. ä¿å­˜

#### 3. åœ¨é£ä¹¦æ–‡æ¡£ä¸­æ‰“å¼€æ’ä»¶

1. æ‰“å¼€é£ä¹¦å¤šç»´è¡¨æ ¼
2. æ’å…¥ç½‘é¡µåº”ç”¨
3. è¾“å…¥ä½ çš„æ’ä»¶ URL
4. æˆæƒå¹¶æ‰“å¼€

#### 4. æ‰“å¼€å¼€å‘è€…å·¥å…·

åœ¨é£ä¹¦æ–‡æ¡£ä¸­ï¼š
- æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
- æˆ–è€…å³é”®é€‰æ‹©"æ£€æŸ¥"

> âš ï¸ **æ³¨æ„**ï¼šé£ä¹¦æ–‡æ¡£ä¸­çš„å¼€å‘è€…å·¥å…·å¯èƒ½éœ€è¦ç‰¹æ®Šæ–¹å¼æ‰“å¼€ï¼Œå…·ä½“å–å†³äºé£ä¹¦ç‰ˆæœ¬ã€‚

### æ–¹æ³•äºŒï¼šä½¿ç”¨é£ä¹¦å¼€å‘è€…å·¥å…·

1. ä¸‹è½½ [é£ä¹¦å¼€å‘è€…å·¥å…·](https://open.feishu.cn/document/tools-and-resources/development-tools/feishu-developer-tools)
2. å¯¼å…¥é¡¹ç›®
3. é…ç½®åº”ç”¨ä¿¡æ¯
4. å¯åŠ¨è°ƒè¯•

---

## æµè§ˆå™¨å¼€å‘è€…å·¥å…·

### Console æ ‡ç­¾ - æŸ¥çœ‹æ—¥å¿—

#### æŸ¥çœ‹æ’ä»¶æ—¥å¿—

æ’ä»¶ä»£ç ä¸­æœ‰å¤šå¤„ `console.log`ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹ï¼š

```javascript
// åœ¨ FilterMonitor.tsx ä¸­
console.log('âœ… å·²æˆåŠŸè®¢é˜…è§†å›¾å˜åŒ–äº‹ä»¶')
console.log('ğŸ“Š æ£€æµ‹åˆ°è§†å›¾é€‰æ‹©å˜åŒ–ï¼Œé‡æ–°è·å–ç­›é€‰æ¡ä»¶')
console.log('ğŸ”„ å·²å¯åŠ¨è½®è¯¢æ£€æŸ¥ï¼Œé—´éš”: 3000ms')
```

#### æ‰‹åŠ¨æµ‹è¯• bitable API

åœ¨æ§åˆ¶å°è¿è¡Œï¼š

```javascript
// æ£€æŸ¥ bitable æ˜¯å¦å­˜åœ¨
console.log(window.bitable)

// æµ‹è¯•è·å–è¡¨æ ¼
const base = await window.bitable.base.getActiveBase()
console.log('Base:', base)

// è·å–è¡¨æ ¼
const table = await base.getActiveTable()
console.log('Table:', table)

// è·å–è§†å›¾
const view = await table.getActiveView()
console.log('View:', view)

// è·å–ç­›é€‰ä¿¡æ¯
const filterInfo = await view.getFilterInfo()
console.log('Filter Info:', filterInfo)
```

### Sources æ ‡ç­¾ - æ–­ç‚¹è°ƒè¯•

#### è®¾ç½®æ–­ç‚¹

1. æ‰“å¼€ Sources æ ‡ç­¾
2. æ‰¾åˆ° `components/FilterMonitor.tsx`
3. ç‚¹å‡»è¡Œå·è®¾ç½®æ–­ç‚¹
4. è§¦å‘æ“ä½œï¼ˆå¦‚ç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼‰
5. ä»£ç ä¼šåœ¨æ–­ç‚¹å¤„æš‚åœ

#### è°ƒè¯•æŠ€å·§

- **Step Over (F10)**ï¼šå•æ­¥æ‰§è¡Œ
- **Step Into (F11)**ï¼šè¿›å…¥å‡½æ•°
- **Step Out (Shift+F11)**ï¼šè·³å‡ºå‡½æ•°
- **Resume (F8)**ï¼šç»§ç»­æ‰§è¡Œ

### Network æ ‡ç­¾ - æŸ¥çœ‹ç½‘ç»œè¯·æ±‚

æŸ¥çœ‹ï¼š
- é¡µé¢åŠ è½½æ—¶é—´
- API è¯·æ±‚çŠ¶æ€
- é”™è¯¯è¯·æ±‚

### Application æ ‡ç­¾ - æŸ¥çœ‹å­˜å‚¨

æŸ¥çœ‹ï¼š
- Local Storage
- Session Storage
- Cookies

---

## å¸¸è§è°ƒè¯•åœºæ™¯

### åœºæ™¯ 1ï¼šbitable ä¸å­˜åœ¨

**ç—‡çŠ¶**ï¼šæ§åˆ¶å°æ˜¾ç¤º "è¯·åœ¨é£ä¹¦æ–‡æ¡£ç¯å¢ƒä¸­ä½¿ç”¨æ­¤æ’ä»¶"

**è°ƒè¯•æ­¥éª¤**ï¼š

```javascript
// 1. æ£€æŸ¥ window å¯¹è±¡
console.log(typeof window)

// 2. æ£€æŸ¥ bitable
console.log(window.bitable)

// 3. æ£€æŸ¥æ˜¯å¦åœ¨é£ä¹¦ç¯å¢ƒ
if (window.bitable) {
  console.log('âœ… åœ¨é£ä¹¦ç¯å¢ƒä¸­')
} else {
  console.log('âŒ ä¸åœ¨é£ä¹¦ç¯å¢ƒä¸­')
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿åœ¨é£ä¹¦æ–‡æ¡£ä¸­æ‰“å¼€æ’ä»¶
- æ£€æŸ¥æ’ä»¶ URL æ˜¯å¦æ­£ç¡®é…ç½®

### åœºæ™¯ 2ï¼šæ— æ³•è·å–ç­›é€‰æ¡ä»¶

**ç—‡çŠ¶**ï¼šç•Œé¢æ˜¾ç¤ºé”™è¯¯æˆ–åŠ è½½å¤±è´¥

**è°ƒè¯•æ­¥éª¤**ï¼š

```javascript
// 1. æµ‹è¯•è·å– base
try {
  const base = await window.bitable.base.getActiveBase()
  console.log('Base:', base)
} catch (err) {
  console.error('è·å– Base å¤±è´¥:', err)
}

// 2. æµ‹è¯•è·å– table
try {
  const table = await base.getActiveTable()
  console.log('Table:', table)
} catch (err) {
  console.error('è·å– Table å¤±è´¥:', err)
}

// 3. æµ‹è¯•è·å– view
try {
  const view = await table.getActiveView()
  console.log('View:', view)
} catch (err) {
  console.error('è·å– View å¤±è´¥:', err)
}

// 4. æµ‹è¯•è·å–ç­›é€‰ä¿¡æ¯
try {
  const filterInfo = await view.getFilterInfo()
  console.log('Filter Info:', filterInfo)
} catch (err) {
  console.error('è·å–ç­›é€‰ä¿¡æ¯å¤±è´¥:', err)
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥æƒé™æ˜¯å¦å·²ç”³è¯·
- ç¡®è®¤å½“å‰è§†å›¾æœ‰ç­›é€‰æ¡ä»¶
- æŸ¥çœ‹é”™è¯¯ä¿¡æ¯å®šä½é—®é¢˜

### åœºæ™¯ 3ï¼šäº‹ä»¶ç›‘å¬ä¸å·¥ä½œ

**ç—‡çŠ¶**ï¼šç­›é€‰æ¡ä»¶å˜åŒ–åä¸è‡ªåŠ¨æ›´æ–°

**è°ƒè¯•æ­¥éª¤**ï¼š

```javascript
// 1. æ£€æŸ¥äº‹ä»¶ç›‘å¬æ˜¯å¦æ³¨å†Œ
const bitable = window.bitable
if (bitable.base && typeof bitable.base.onSelectionChange === 'function') {
  console.log('âœ… onSelectionChange å¯ç”¨')
  
  // 2. æ‰‹åŠ¨æ³¨å†Œç›‘å¬
  const unsubscribe = bitable.base.onSelectionChange(() => {
    console.log('ğŸ“Š äº‹ä»¶è§¦å‘ï¼')
  })
  
  console.log('âœ… äº‹ä»¶ç›‘å¬å·²æ³¨å†Œ')
} else {
  console.log('âŒ onSelectionChange ä¸å¯ç”¨')
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- ç¡®è®¤äº‹ä»¶ç›‘å¬å·²æˆåŠŸæ³¨å†Œ
- è½®è¯¢æœºåˆ¶ä¼šæ¯ 3 ç§’æ£€æŸ¥ä¸€æ¬¡ä½œä¸ºå¤‡ç”¨

### åœºæ™¯ 4ï¼šTypeScript ç±»å‹é”™è¯¯

**ç—‡çŠ¶**ï¼šIDE æ˜¾ç¤ºç±»å‹é”™è¯¯

**è°ƒè¯•æ­¥éª¤**ï¼š

1. æ£€æŸ¥ `types/bitable.d.ts` æ˜¯å¦å­˜åœ¨
2. æ£€æŸ¥ `tsconfig.json` é…ç½®
3. é‡å¯ TypeScript æœåŠ¡å™¨ï¼ˆVS Code: `Ctrl+Shift+P` â†’ "TypeScript: Restart TS Server"ï¼‰

---

## è°ƒè¯•æŠ€å·§

### 1. æ·»åŠ è¯¦ç»†æ—¥å¿—

åœ¨ä»£ç ä¸­æ·»åŠ æ›´å¤šæ—¥å¿—ï¼š

```typescript
const getFilterInfo = async () => {
  console.log('ğŸ” å¼€å§‹è·å–ç­›é€‰æ¡ä»¶...')
  
  try {
    console.log('1. æ£€æŸ¥ç¯å¢ƒ...')
    if (typeof window === 'undefined' || !(window as any).bitable) {
      throw new Error('è¯·åœ¨é£ä¹¦æ–‡æ¡£ç¯å¢ƒä¸­ä½¿ç”¨æ­¤æ’ä»¶')
    }
    
    console.log('2. è·å– bitable å¯¹è±¡...')
    const bitable = (window as any).bitable
    
    console.log('3. è·å– base...')
    const base = await bitable.base.getActiveBase()
    console.log('Base:', base)
    
    console.log('4. è·å– table...')
    const table = await base.getActiveTable()
    console.log('Table:', table)
    
    console.log('5. è·å– view...')
    const view = await table.getActiveView()
    console.log('View:', view)
    
    console.log('6. è·å–ç­›é€‰ä¿¡æ¯...')
    const filterInfo = await view.getFilterInfo()
    console.log('Filter Info:', filterInfo)
    
    // ... å¤„ç†æ•°æ®
  } catch (err) {
    console.error('âŒ é”™è¯¯è¯¦æƒ…:', err)
    console.error('é”™è¯¯å †æ ˆ:', err.stack)
  }
}
```

### 2. ä½¿ç”¨ debugger è¯­å¥

åœ¨ä»£ç ä¸­æ·»åŠ  `debugger` è¯­å¥ï¼š

```typescript
const getFilterInfo = async () => {
  debugger // æµè§ˆå™¨ä¼šåœ¨è¿™é‡Œæš‚åœ
  
  const bitable = (window as any).bitable
  // ...
}
```

### 3. æ¡ä»¶æ–­ç‚¹

åœ¨ Sources æ ‡ç­¾ä¸­ï¼š
1. å³é”®ç‚¹å‡»æ–­ç‚¹
2. é€‰æ‹© "Edit breakpoint"
3. æ·»åŠ æ¡ä»¶ï¼Œä¾‹å¦‚ï¼š`filterInfo.conditions.length > 0`

### 4. ç›‘æ§å˜é‡

åœ¨ Console ä¸­ç›‘æ§å˜é‡ï¼š

```javascript
// ç›‘æ§ filterInfo
let filterInfo = null
Object.defineProperty(window, 'filterInfo', {
  get: () => filterInfo,
  set: (val) => {
    console.log('filterInfo å˜åŒ–:', val)
    filterInfo = val
  }
})
```

### 5. æ€§èƒ½åˆ†æ

ä½¿ç”¨ Performance æ ‡ç­¾ï¼š
1. ç‚¹å‡» Record
2. æ‰§è¡Œæ“ä½œ
3. åœæ­¢å½•åˆ¶
4. æŸ¥çœ‹æ€§èƒ½åˆ†æ

---

## è°ƒè¯•å·¥å…·æ¨è

### 1. React Developer Tools

å®‰è£…æµè§ˆå™¨æ‰©å±•ï¼š
- [Chrome æ‰©å±•](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi)
- [Firefox æ‰©å±•](https://addons.mozilla.org/en-US/firefox/addon/react-devtools/)

å¯ä»¥æŸ¥çœ‹ï¼š
- React ç»„ä»¶æ ‘
- Props å’Œ State
- ç»„ä»¶æ€§èƒ½

### 2. Redux DevToolsï¼ˆå¦‚æœä½¿ç”¨ Reduxï¼‰

### 3. Vue DevToolsï¼ˆå¦‚æœä½¿ç”¨ Vueï¼‰

---

## å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### é”™è¯¯ 1ï¼šCannot read property 'bitable' of undefined

**åŸå› **ï¼š`window` å¯¹è±¡ä¸å­˜åœ¨ï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰

**è§£å†³**ï¼šæ£€æŸ¥ `typeof window !== 'undefined'`

### é”™è¯¯ 2ï¼šbitable.base.getActiveBase is not a function

**åŸå› **ï¼šAPI ç‰ˆæœ¬ä¸åŒ¹é…æˆ–æƒé™ä¸è¶³

**è§£å†³**ï¼š
- æ£€æŸ¥æƒé™æ˜¯å¦å·²ç”³è¯·
- æŸ¥çœ‹é£ä¹¦ API æ–‡æ¡£ç¡®è®¤æ–¹æ³•å

### é”™è¯¯ 3ï¼šPromise rejected

**åŸå› **ï¼šå¼‚æ­¥æ“ä½œå¤±è´¥

**è§£å†³**ï¼š
- ä½¿ç”¨ `try-catch` æ•è·é”™è¯¯
- æŸ¥çœ‹é”™è¯¯è¯¦æƒ…
- æ£€æŸ¥ç½‘ç»œè¿æ¥

---

## è°ƒè¯•æ£€æŸ¥æ¸…å•

- [ ] å¼€å‘æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ— é”™è¯¯
- [ ] `window.bitable` å­˜åœ¨
- [ ] æƒé™å·²ç”³è¯·
- [ ] äº‹ä»¶ç›‘å¬å·²æ³¨å†Œ
- [ ] ç½‘ç»œè¯·æ±‚æ­£å¸¸
- [ ] TypeScript æ— ç±»å‹é”™è¯¯
- [ ] ä»£ç å·²ä¿å­˜
- [ ] æµè§ˆå™¨å·²åˆ·æ–°

---

## è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ç½‘ç»œè¯·æ±‚çŠ¶æ€
3. æŸ¥çœ‹é£ä¹¦å®˜æ–¹æ–‡æ¡£
4. æäº¤ Issue åˆ°é¡¹ç›®ä»“åº“

---

**ç¥ä½ è°ƒè¯•é¡ºåˆ©ï¼** ğŸ›ğŸ”

