# é£ä¹¦æ–‡æ¡£ç­›é€‰æ¡ä»¶è·å–æ’ä»¶

è¿™æ˜¯ä¸€ä¸ªé£ä¹¦æ–‡æ¡£æ’ä»¶ï¼Œç”¨äºå®æ—¶è·å–å’Œç›‘æ§æ–‡æ¡£çš„ç­›é€‰æ¡ä»¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… å®æ—¶ç›‘å¬æ–‡æ¡£ç­›é€‰æ¡ä»¶çš„å˜åŒ–
- âœ… è‡ªåŠ¨è·å–å½“å‰è§†å›¾çš„ç­›é€‰æ¡ä»¶
- âœ… æ˜¾ç¤ºç­›é€‰æ¡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå­—æ®µåã€æ“ä½œç¬¦ã€ç­›é€‰å€¼ï¼‰
- âœ… æ”¯æŒæ‰‹åŠ¨åˆ·æ–°ç­›é€‰æ¡ä»¶
- âœ… å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒ Web å’Œ H5

## æŠ€æœ¯æ ˆ

- **Next.js 13+** (App Router)
- **React 18**
- **TypeScript**
- **Tailwind CSS**

## å®‰è£…å’Œè¿è¡Œ

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å¼€å‘æ¨¡å¼è¿è¡Œ

```bash
npm run dev
```

### 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

## é…ç½®è¯´æ˜

### manifest.json

åœ¨ `manifest.json` ä¸­é…ç½®ä½ çš„æ’ä»¶ä¿¡æ¯ï¼š

```json
{
  "app_id": "your_app_id",
  "app_name": "æ–‡æ¡£ç­›é€‰æ¡ä»¶è·å–æ’ä»¶",
  "scopes": [
    "bitable:app",
    "bitable:app:readonly",
    "bitable:app:readwrite"
  ]
}
```

**é‡è¦é…ç½®é¡¹ï¼š**

- `app_id`: åœ¨é£ä¹¦å¼€æ”¾å¹³å°ç”³è¯·çš„åº”ç”¨ ID
- `scopes`: éœ€è¦ç”³è¯·çš„æƒé™èŒƒå›´
  - `bitable:app`: åŸºç¡€æƒé™
  - `bitable:app:readonly`: åªè¯»æƒé™
  - `bitable:app:readwrite`: è¯»å†™æƒé™

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® `http://localhost:3000` æŸ¥çœ‹æ’ä»¶ç•Œé¢ã€‚

### 3. é…ç½®é£ä¹¦åº”ç”¨

1. åœ¨ [é£ä¹¦å¼€æ”¾å¹³å°](https://open.feishu.cn/) åˆ›å»ºåº”ç”¨
2. **è·å– `App ID`**ï¼ˆåªéœ€è¦è¿™ä¸ªï¼ï¼‰
3. æ›´æ–° `manifest.json` ä¸­çš„ `app_id`
4. ç”³è¯· `bitable:app:readonly` æƒé™

> âœ… **é‡è¦**ï¼šè¿™æ˜¯å®¢æˆ·ç«¯æ’ä»¶ï¼Œ**åªéœ€è¦ App ID**ï¼Œä¸éœ€è¦ App Secretï¼

### 4. éƒ¨ç½²å’Œä½¿ç”¨

è¯¦ç»†æ­¥éª¤è¯·æŸ¥çœ‹ [å®Œæ•´ä½¿ç”¨æŒ‡å—](./docs/ä½¿ç”¨æŒ‡å—.md)

## ä½¿ç”¨æ–¹æ³•

### æœ¬åœ°å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

### åœ¨é£ä¹¦ä¸­ä½¿ç”¨

1. **éƒ¨ç½²æ’ä»¶**ï¼šå°†é¡¹ç›®éƒ¨ç½²åˆ°æ”¯æŒ HTTPS çš„æœåŠ¡å™¨
2. **é…ç½®åº”ç”¨**ï¼šåœ¨é£ä¹¦å¼€æ”¾å¹³å°é…ç½®æ’ä»¶è®¿é—®åœ°å€
3. **æ’å…¥æ’ä»¶**ï¼šåœ¨é£ä¹¦å¤šç»´è¡¨æ ¼ä¸­æ’å…¥ç½‘é¡µåº”ç”¨
4. **å¼€å§‹ä½¿ç”¨**ï¼šæ’ä»¶ä¼šè‡ªåŠ¨è·å–å’Œæ˜¾ç¤ºç­›é€‰æ¡ä»¶

> ğŸ“– **è¯¦ç»†æ­¥éª¤**ï¼šè¯·æŸ¥çœ‹ [å®Œæ•´ä½¿ç”¨æŒ‡å—](./docs/ä½¿ç”¨æŒ‡å—.md)

## API ä½¿ç”¨è¯´æ˜

### è·å–ç­›é€‰æ¡ä»¶

æ’ä»¶ä½¿ç”¨é£ä¹¦ Bitable API è·å–ç­›é€‰æ¡ä»¶ï¼š

```typescript
// è·å–å½“å‰è¡¨æ ¼å®ä¾‹
const base = await bitable.base.getActiveBase()
const table = await base.getActiveTable()
const view = await table.getActiveView()

// è·å–è§†å›¾çš„ç­›é€‰ä¿¡æ¯
const filterInfo = await view.getFilterInfo()
```

### ç­›é€‰æ¡ä»¶ç»“æ„

```typescript
interface FilterCondition {
  fieldId: string      // å­—æ®µ ID
  fieldName: string    // å­—æ®µåç§°
  operator: string     // æ“ä½œç¬¦ï¼ˆis, contains, isGreater ç­‰ï¼‰
  value: any          // ç­›é€‰å€¼
}
```

### æ”¯æŒçš„æ“ä½œç¬¦

- `is`: ç­‰äº
- `isNot`: ä¸ç­‰äº
- `contains`: åŒ…å«
- `doesNotContain`: ä¸åŒ…å«
- `isEmpty`: ä¸ºç©º
- `isNotEmpty`: ä¸ä¸ºç©º
- `isGreater`: å¤§äº
- `isGreaterEqual`: å¤§äºç­‰äº
- `isLess`: å°äº
- `isLessEqual`: å°äºç­‰äº
- `isBefore`: æ—©äº
- `isAfter`: æ™šäº
- `isOnOrBefore`: æ—©äºæˆ–ç­‰äº
- `isOnOrAfter`: æ™šäºæˆ–ç­‰äº

## å¼€å‘è¯´æ˜

### é¡¹ç›®ç»“æ„

```
feishu-plugin/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ globals.css      # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ layout.tsx       # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ page.tsx         # ä¸»é¡µé¢
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â””â”€â”€ card.tsx     # Card ç»„ä»¶
â”‚   â””â”€â”€ FilterMonitor.tsx # ç­›é€‰ç›‘æ§ç»„ä»¶
â”œâ”€â”€ manifest.json        # æ’ä»¶é…ç½®æ–‡ä»¶
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

### æ ¸å¿ƒç»„ä»¶

#### FilterMonitor

ä¸»ç»„ä»¶ï¼Œè´Ÿè´£ï¼š
- ç›‘å¬ç­›é€‰æ¡ä»¶å˜åŒ–
- è·å–å¹¶æ˜¾ç¤ºç­›é€‰æ¡ä»¶
- å¤„ç†é”™è¯¯å’ŒåŠ è½½çŠ¶æ€

## æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒè¦æ±‚**ï¼šæ’ä»¶å¿…é¡»åœ¨é£ä¹¦æ–‡æ¡£ç¯å¢ƒä¸­è¿è¡Œï¼Œéœ€è¦è®¿é—® `window.bitable` API
2. **æƒé™ç”³è¯·**ï¼šç¡®ä¿åœ¨é£ä¹¦å¼€æ”¾å¹³å°ç”³è¯·äº†å¿…è¦çš„æƒé™
3. **API ç‰ˆæœ¬**ï¼šä¸åŒç‰ˆæœ¬çš„é£ä¹¦ API å¯èƒ½æœ‰å·®å¼‚ï¼Œè¯·å‚è€ƒæœ€æ–°çš„å®˜æ–¹æ–‡æ¡£
4. **é”™è¯¯å¤„ç†**ï¼šæ’ä»¶åŒ…å«é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä¼šåœ¨éé£ä¹¦ç¯å¢ƒä¸­æç¤ºç”¨æˆ·

## å¸¸è§é—®é¢˜

### Q: æ’ä»¶æ— æ³•è·å–ç­›é€‰æ¡ä»¶ï¼Ÿ

A: è¯·æ£€æŸ¥ï¼š
- æ˜¯å¦åœ¨é£ä¹¦æ–‡æ¡£ç¯å¢ƒä¸­è¿è¡Œ
- æ˜¯å¦ç”³è¯·äº†æ­£ç¡®çš„æƒé™
- å½“å‰è§†å›¾æ˜¯å¦æœ‰ç­›é€‰æ¡ä»¶

### Q: ç­›é€‰æ¡ä»¶å˜åŒ–åæ²¡æœ‰è‡ªåŠ¨æ›´æ–°ï¼Ÿ

A: æ’ä»¶ä¼šå®šæœŸæ£€æŸ¥ç­›é€‰æ¡ä»¶ï¼ˆæ¯2ç§’ï¼‰ï¼Œå¦‚æœä»æ— æ³•åŠæ—¶æ›´æ–°ï¼Œå¯ä»¥æ‰‹åŠ¨ç‚¹å‡»"åˆ·æ–°"æŒ‰é’®ã€‚

## å‚è€ƒæ–‡æ¡£

- [é£ä¹¦å¼€æ”¾å¹³å°æ–‡æ¡£](https://open.feishu.cn/document/)
- [é£ä¹¦ Bitable API æ–‡æ¡£](https://open.feishu.cn/document/server-docs/docs/bitable-v1/overview)

## è®¸å¯è¯

MIT

